//------------------------------------------------------------------------------
//Filename       macs.h
//System         
//Author         Paul.   
//Date           Thu 17 Feb 2000
//Description    
//------------------------------------------------------------------------------
#ifndef	MACS_Included
#define	MACS_Included

#define	DEFAULT_MACS 0

#define MatMulCEqAxB(c,a,b)\
(c)[0]	=	(a)[3]	*	(b)[12]	+	(a)[2]	*	(b)[8]	+	(a)[1]	*	(b)[4]	+	(a)[0]	*	(b)[0];\
(c)[1]	=	(a)[3]	*	(b)[13]	+	(a)[2]	*	(b)[9]	+	(a)[1]	*	(b)[5]	+	(a)[0]	*	(b)[1];\
(c)[2]	=	(a)[3]	*	(b)[14]	+	(a)[2]	*	(b)[10]	+	(a)[1]	*	(b)[6]	+	(a)[0]	*	(b)[2];\
(c)[3]	=	(a)[3]	*	(b)[15]	+	(a)[2]	*	(b)[11]	+	(a)[1]	*	(b)[7]	+	(a)[0]	*	(b)[3];\
(c)[4]	=	(a)[7]	*	(b)[12]	+	(a)[6]	*	(b)[8]	+	(a)[5]	*	(b)[4]	+	(a)[4]	*	(b)[0];\
(c)[5]	=	(a)[7]	*	(b)[13]	+	(a)[6]	*	(b)[9]	+	(a)[5]	*	(b)[5]	+	(a)[4]	*	(b)[1];\
(c)[6]	=	(a)[7]	*	(b)[14]	+	(a)[6]	*	(b)[10]	+	(a)[5]	*	(b)[6]	+	(a)[4]	*	(b)[2];\
(c)[7]	=	(a)[7]	*	(b)[15]	+	(a)[6]	*	(b)[11]	+	(a)[5]	*	(b)[7]	+	(a)[4]	*	(b)[3];\
(c)[8]	=	(a)[11]	*	(b)[12]	+	(a)[10]	*	(b)[8]	+	(a)[9]	*	(b)[4]	+	(a)[8]	*	(b)[0];\
(c)[9]	=	(a)[11]	*	(b)[13]	+	(a)[10]	*	(b)[9]	+	(a)[9]	*	(b)[5]	+	(a)[8]	*	(b)[1];\
(c)[10]	=	(a)[11]	*	(b)[14]	+	(a)[10]	*	(b)[10]	+	(a)[9]	*	(b)[6]	+	(a)[8]	*	(b)[2];\
(c)[11]	=	(a)[11]	*	(b)[15]	+	(a)[10]	*	(b)[11]	+	(a)[9]	*	(b)[7]	+	(a)[8]	*	(b)[3];\
(c)[12]	=	(a)[15]	*	(b)[12]	+	(a)[14]	*	(b)[8]	+	(a)[13]	*	(b)[4]	+	(a)[12]	*	(b)[0];\
(c)[13]	=	(a)[15]	*	(b)[13]	+	(a)[14]	*	(b)[9]	+	(a)[13]	*	(b)[5]	+	(a)[12]	*	(b)[1];\
(c)[14]	=	(a)[15]	*	(b)[14]	+	(a)[14]	*	(b)[10]	+	(a)[13]	*	(b)[6]	+	(a)[12]	*	(b)[2];\
(c)[15]	=	(a)[15]	*	(b)[15]	+	(a)[14]	*	(b)[11]	+	(a)[13]	*	(b)[7]	+	(a)[12]	*	(b)[3];

#define MatMulCEqAxB_AisRot(c,a,b)\
(c)[0]	=	(a)[2]	*	(b)[8]	+	(a)[1]	*	(b)[4]	+	(a)[0]	*	(b)[0];\
(c)[1]	=	(a)[2]	*	(b)[9]	+	(a)[1]	*	(b)[5]	+	(a)[0]	*	(b)[1];\
(c)[2]	=	(a)[2]	*	(b)[10]	+	(a)[1]	*	(b)[6]	+	(a)[0]	*	(b)[2];\
(c)[3]	=	(a)[2]	*	(b)[11]	+	(a)[1]	*	(b)[7]	+	(a)[0]	*	(b)[3];\
(c)[4]	=	(a)[6]	*	(b)[8]	+	(a)[5]	*	(b)[4]	+	(a)[4]	*	(b)[0];\
(c)[5]	=	(a)[6]	*	(b)[9]	+	(a)[5]	*	(b)[5]	+	(a)[4]	*	(b)[1];\
(c)[6]	=	(a)[6]	*	(b)[10]	+	(a)[5]	*	(b)[6]	+	(a)[4]	*	(b)[2];\
(c)[7]	=	(a)[6]	*	(b)[11]	+	(a)[5]	*	(b)[7]	+	(a)[4]	*	(b)[3];\
(c)[8]	=	(a)[10]	*	(b)[8]	+	(a)[9]	*	(b)[4]	+	(a)[8]	*	(b)[0];\
(c)[9]	=	(a)[10]	*	(b)[9]	+	(a)[9]	*	(b)[5]	+	(a)[8]	*	(b)[1];\
(c)[10]	=	(a)[10]	*	(b)[10]	+	(a)[9]	*	(b)[6]	+	(a)[8]	*	(b)[2];\
(c)[11]	=	(a)[10]	*	(b)[11]	+	(a)[9]	*	(b)[7]	+	(a)[8]	*	(b)[3];\
(c)[12]	=	(b)[12]	+	(a)[14]	*	(b)[8]	+	(a)[13]	*	(b)[4]	+	(a)[12]	*	(b)[0];\
(c)[13]	=	(b)[13]	+	(a)[14]	*	(b)[9]	+	(a)[13]	*	(b)[5]	+	(a)[12]	*	(b)[1];\
(c)[14]	=	(b)[14]	+	(a)[14]	*	(b)[10]	+	(a)[13]	*	(b)[6]	+	(a)[12]	*	(b)[2];\
(c)[15]	=	(b)[15]	+	(a)[14]	*	(b)[11]	+	(a)[13]	*	(b)[7]	+	(a)[12]	*	(b)[3];

#define MatMulCEqAxB_BisRot(c,a,b)\
(c)[0]	=	(a)[3]	*	(b)[12]	+	(a)[2]	*	(b)[8]	+	(a)[1]	*	(b)[4]	+	(a)[0]	*	(b)[0];\
(c)[1]	=	(a)[3]	*	(b)[13]	+	(a)[2]	*	(b)[9]	+	(a)[1]	*	(b)[5]	+	(a)[0]	*	(b)[1];\
(c)[2]	=	(a)[3]	*	(b)[14]	+	(a)[2]	*	(b)[10]	+	(a)[1]	*	(b)[6]	+	(a)[0]	*	(b)[2];\
(c)[3]	=	(a)[3];\
(c)[4]	=	(a)[7]	*	(b)[12]	+	(a)[6]	*	(b)[8]	+	(a)[5]	*	(b)[4]	+	(a)[4]	*	(b)[0];\
(c)[5]	=	(a)[7]	*	(b)[13]	+	(a)[6]	*	(b)[9]	+	(a)[5]	*	(b)[5]	+	(a)[4]	*	(b)[1];\
(c)[6]	=	(a)[7]	*	(b)[14]	+	(a)[6]	*	(b)[10]	+	(a)[5]	*	(b)[6]	+	(a)[4]	*	(b)[2];\
(c)[7]	=	(a)[7];\
(c)[8]	=	(a)[11]	*	(b)[12]	+	(a)[10]	*	(b)[8]	+	(a)[9]	*	(b)[4]	+	(a)[8]	*	(b)[0];\
(c)[9]	=	(a)[11]	*	(b)[13]	+	(a)[10]	*	(b)[9]	+	(a)[9]	*	(b)[5]	+	(a)[8]	*	(b)[1];\
(c)[10]	=	(a)[11]	*	(b)[14]	+	(a)[10]	*	(b)[10]	+	(a)[9]	*	(b)[6]	+	(a)[8]	*	(b)[2];\
(c)[11]	=	(a)[11];\
(c)[12]	=	(a)[15]	*	(b)[12]	+	(a)[14]	*	(b)[8]	+	(a)[13]	*	(b)[4]	+	(a)[12]	*	(b)[0];\
(c)[13]	=	(a)[15]	*	(b)[13]	+	(a)[14]	*	(b)[9]	+	(a)[13]	*	(b)[5]	+	(a)[12]	*	(b)[1];\
(c)[14]	=	(a)[15]	*	(b)[14]	+	(a)[14]	*	(b)[10]	+	(a)[13]	*	(b)[6]	+	(a)[12]	*	(b)[2];\
(c)[15]	=	(a)[15];

#define MatMulCEqAxB_AisRot_BisRot(c,a,b)\
(c)[0]	=	(a)[2]	*	(b)[8]	+	(a)[1]	*	(b)[4]	+	(a)[0]	*	(b)[0];\
(c)[1]	=	(a)[2]	*	(b)[9]	+	(a)[1]	*	(b)[5]	+	(a)[0]	*	(b)[1];\
(c)[2]	=	(a)[2]	*	(b)[10]	+	(a)[1]	*	(b)[6]	+	(a)[0]	*	(b)[2];\
(c)[3]	=	0.f;\
(c)[4]	=	(a)[6]	*	(b)[8]	+	(a)[5]	*	(b)[4]	+	(a)[4]	*	(b)[0];\
(c)[5]	=	(a)[6]	*	(b)[9]	+	(a)[5]	*	(b)[5]	+	(a)[4]	*	(b)[1];\
(c)[6]	=	(a)[6]	*	(b)[10]	+	(a)[5]	*	(b)[6]	+	(a)[4]	*	(b)[2];\
(c)[7]	=	0.f;\
(c)[8]	=	(a)[10]	*	(b)[8]	+	(a)[9]	*	(b)[4]	+	(a)[8]	*	(b)[0];\
(c)[9]	=	(a)[10]	*	(b)[9]	+	(a)[9]	*	(b)[5]	+	(a)[8]	*	(b)[1];\
(c)[10]	=	(a)[10]	*	(b)[10]	+	(a)[9]	*	(b)[6]	+	(a)[8]	*	(b)[2];\
(c)[11]	=	0.f;\
(c)[12]	=	(b)[12]	+	(a)[14]	*	(b)[8]	+	(a)[13]	*	(b)[4]	+	(a)[12]	*	(b)[0];\
(c)[13]	=	(b)[13]	+	(a)[14]	*	(b)[9]	+	(a)[13]	*	(b)[5]	+	(a)[12]	*	(b)[1];\
(c)[14]	=	(b)[14]	+	(a)[14]	*	(b)[10]	+	(a)[13]	*	(b)[6]	+	(a)[12]	*	(b)[2];\
(c)[15]	=	1.f;

#define MatMulCEqAxB_AisRot_BisPerspective(c,a,b)\
(c)[0]	=	(a)[0]	*	(b)[0];\
(c)[1]	=	(a)[1]	*	(b)[5];\
(c)[2]	=	(a)[2]	*	(b)[10];\
(c)[3]	=	(a)[2];\
(c)[4]	=	(a)[4]	*	(b)[0];\
(c)[5]	=	(a)[5]	*	(b)[5];\
(c)[6]	=	(a)[6]	*	(b)[10];\
(c)[7]	=	(a)[6];\
(c)[8]	=	(a)[8]	*	(b)[0];\
(c)[9]	=	(a)[9]	*	(b)[5];\
(c)[10]	=	(a)[10]	*	(b)[10];\
(c)[11]	=	(a)[10];\
(c)[12]	=	(a)[12]	*	(b)[0];\
(c)[13]	=	(a)[13]	*	(b)[5];\
(c)[14]	=	(b)[14]	+	(a)[14]	*	(b)[10];\
(c)[15]	=	(a)[14];

#define VecCrossCEqAxB(c,a,b)\
(c)->dvX=(a)->dvY*(b)->dvZ-(a)->dvZ*(b)->dvY;\
(c)->dvY=(a)->dvX*(b)->dvZ-(a)->dvZ*(b)->dvX;\
(c)->dvZ=(a)->dvX*(b)->dvY-(a)->dvY*(b)->dvX;

#define VecTransform(v,m)\
{	D3DVECTOR zXcVbN=*(v);\
	(v)->dvX=zXcVbN.dvX*(m)->_11+zXcVbN.dvY*(m)->_21+zXcVbN.dvZ*(m)->_31+(m)->_41;\
	(v)->dvY=zXcVbN.dvX*(m)->_12+zXcVbN.dvY*(m)->_22+zXcVbN.dvZ*(m)->_32+(m)->_42;\
	(v)->dvZ=zXcVbN.dvX*(m)->_13+zXcVbN.dvY*(m)->_23+zXcVbN.dvZ*(m)->_33+(m)->_43;\
}

#define VecNormalise(v)\
{	D3DVALUE zXcVbN=(v)->dvX*(v)->dvX+(v)->dvY*(v)->dvY+(v)->dvZ*(v)->dvZ;\
	zXcVbN=1.f/FastSqrt(zXcVbN);\
	(v)->dvX*=zXcVbN;\
	(v)->dvY*=zXcVbN;\
	(v)->dvZ*=zXcVbN;\
}

#define VecDotProduct(a,b) ((a)->dvX*(b)->dvX+(a)->dvY*(b)->dvY+(a)->dvZ*(b)->dvZ)

#endif



